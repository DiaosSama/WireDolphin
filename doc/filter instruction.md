# 报文过滤使用说明书

一、过滤属性；

包的过滤属性值有：

1. proto：包使用的网络协议；
2. ip.s：包的源地址；
3. ip.d：包的目的地址；
4. port.s：包的源端口；
5.  port.d：包的目的端口；
6.  net.s：源ip所在的子网；
7.  net.d：目的ip所在的子网；
8.  len：包的长度；

属性赋值说明：

​    使用“==”给关键词复制的形式有两种，赋值语句中不能有空格；

1. proto：包使用的网络协议，支持的协议有："TCP", "TCPv6", "UDP", "UDPv6", "HTTP", "HTTPS", "DNS", "DNSv6","MDNS", "MDNSv6", "SSDP", "SSDPv6", "ICMP", "ICMPv6", "ARP"；

   赋值形式：proto==value1,value2,…,valuen；
2. ip.s：包的源地址；赋值形式：ip.s==value1,value2,…,valuen；

   注意：如果ip.s是ipv6地址，必须使用该形式：X:X:X:X:X:X:X:X 
3. ip.d：包的目的地址；

   参考ip.s。
4. port.s：包的源端口；

   赋值形式1：port.s==value1,value2,…,valuen；

   赋值形式2：port.s\==[min,max];指定范围的端口号；例如：port.s==[21,100]，表示端口号在21到100之间，包括21,和100
5. port.d：包的目的端口；

   参考port.s。
6. net.s：源ip所在的子网；

   赋值形式：net.s\==ip/n；指定子网ip/n赋值给net.s；赋值的时候，需要给出一个在指定子网的ip，给出子网占位数n；例如：net.s==192.168.0.103/8；

   注：该属性不支持多值赋值，只支持IPV4地址。
7. net.d：目的ip所在的子网；

   参考：net.s。
8. len：包的长度；

   赋值形式1：len==value1,value2,…,valuen；

   赋值形式2：len\==[min,max];指定范围的端口号；例如：len==[21,100]，表示包长度在21到100之间，包括21,和100

二、 过滤规则；

（一）单属性过滤。

使用“\==”给关键词复制的形式有两种，“==”前后不能有空格；

a） 单值；

形式：key_word==value。如果value为空，则默认没有输入过滤条件，句法判断为正确。

egs: 

（1）  port.s==80；

说明：筛选端口号为80的包；

（2）  ip.s==192.168.0.103

说明：筛选源地址为192.168.0.103的包；

（3）  ip.s ==192.168.0.103

说明：无效。因为在“==”前面有空格。

（4）  proto== UDP

说明：筛选使用了UDP协议的包；

b）多值；

形式：key_word==value1,value2,…valuen；每个值使用英文逗号隔开。中间不能有空格。每个值之间的关系是‘|‘（或）的关系。

需要注意的是，有些属性值的多值形式有其他形式，有些属性值没有多值形式，具体看属性值说明。

egs:

（1）  port.s==80,1024,21

说明：筛选端口号为或者是80,或者是1024，或者是21的包；

（2）  ip.s==192.168.0.103,192.168.4.5

说明：筛选源地址为192.168.0.103或者192.168.4.5的包；

（3）  proto==UDP,TCP

说明：筛选使用了UDP协议，或者TCP协议的包。

（二）多属性过滤；

形式：attribute1\==value1,value2,…,valuen attribute2== value1,value2,…,valuen attributen== value1,value2,…,valuen；属性值之间使用空格隔开，每个属性值的条件是“&“（与）关系。属性之间没有指定的前后顺序。

egs：

（1）  port.s\==80,1024,21 ip.s==192.168.0.103



说明：筛选源地址是192.168.0.103，并且源端口或者是80，或者是1024，或者是21的包。

（2）  port.s\==80,1024,21 ip.s\==192.168.0.103 proto==TCP

说明：筛选源地址是192.168.0.103，并且源端口或者是80，或者是1024，或者是21，并且使用TCP协议的包。

（3）  port.s\==80 proto\==TCP net.s==192.168.0.103/8



说明：筛选源IP在子网192.168.0.103/8，且端口号为80，且使用协议TCP协议的包。